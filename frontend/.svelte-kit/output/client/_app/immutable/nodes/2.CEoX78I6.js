import{a as A,f as B,d as ze,t as hs,c as ri}from"../chunks/CUN6wchY.js";import"../chunks/BurXaNgX.js";import{w as ht,a as ai,b as lt,o as kt}from"../chunks/CK6mn_4X.js";import{m as me,n as oi,O as li,g as l,Q as ci,U as ui,V as ds,F as xt,W as Nt,D as ft,aD as hi,aK as di,av as fs,H as We,L as Ht,aQ as fi,N as vi,aa as pi,aR as Ns,aJ as es,aS as mi,ah as vs,aT as gi,aU as yi,a1 as Y,A as _i,y as Ot,aV as Re,aW as Os,I as Ls,K as Ms,aX as Lt,Z as Bs,aY as bi,aZ as wi,aH as Si,J as Ei,aE as ki,$ as Ai,a_ as Ti,a$ as Ci,b0 as Ii,b1 as Ri,b2 as xi,b3 as Ni,b4 as Oi,b5 as Ds,b6 as Li,aN as Mi,b as x,Y as Bi,b7 as Di,p as xe,k as d,l as h,s as u,e as ot,t as j,j as Ne,b8 as Ps,a2 as $,i as ct,aP as ps,b9 as Ge,ba as ts,aw as ss}from"../chunks/IImCMv-Z.js";import{s as W,e as se}from"../chunks/aYSWzEL-.js";import{p as Ve,i as F,b as At,s as He,a as Ee}from"../chunks/DCSeNEyV.js";import{i as Oe}from"../chunks/CYy9pKZS.js";function Tt(s,e){return e}function Pi(s,e,t){for(var i=[],n=e.length,r,a=e.length,o=0;o<n;o++){let b=e[o];Ms(b,()=>{if(r){if(r.pending.delete(b),r.done.add(b),r.pending.size===0){var f=s.outrogroups;Ft(es(r.done)),f.delete(r),f.size===0&&(s.outrogroups=null)}}else a-=1},!1)}if(a===0){var c=i.length===0&&t!==null;if(c){var m=t,p=m.parentNode;Si(p),p.append(m),s.items.clear()}Ft(e,!c)}else r={pending:new Set(e),done:new Set},(s.outrogroups??(s.outrogroups=new Set)).add(r)}function Ft(s,e=!0){for(var t=0;t<s.length;t++)Ei(s[t],e)}var ms;function Je(s,e,t,i,n,r=null){var a=s,o=new Map,c=(e&Os)!==0;if(c){var m=s;a=me?xt(_i(m)):m.appendChild(Ot())}me&&oi();var p=null,b=pi(()=>{var _=t();return Ns(_)?_:_==null?[]:es(_)}),f,y=!0;function k(){v.fallback=p,Vi(v,f,a,e,i),p!==null&&(f.length===0?(p.f&Re)===0?Ls(p):(p.f^=Re,nt(p,null,a)):Ms(p,()=>{p=null}))}var P=li(()=>{f=l(b);var _=f.length;let C=!1;if(me){var H=ci(a)===ui;H!==(_===0)&&(a=ds(),xt(a),Nt(!1),C=!0)}for(var E=new Set,N=We,T=vi(),S=0;S<_;S+=1){me&&ft.nodeType===hi&&ft.data===di&&(a=ft,C=!0,Nt(!1));var q=f[S],L=i(q,S),U=y?null:o.get(L);U?(U.v&&fs(U.v,q),U.i&&fs(U.i,S),T&&N.unskip_effect(U.e)):(U=Ui(o,y?a:ms??(ms=Ot()),q,L,S,n,e,t),y||(U.e.f|=Re),o.set(L,U)),E.add(L)}if(_===0&&r&&!p&&(y?p=Ht(()=>r(a)):(p=Ht(()=>r(ms??(ms=Ot()))),p.f|=Re)),_>E.size&&fi(),me&&_>0&&xt(ds()),!y)if(T){for(const[ie,X]of o)E.has(ie)||N.skip_effect(X.e);N.oncommit(k),N.ondiscard(()=>{})}else k();C&&Nt(!0),l(b)}),v={effect:P,items:o,outrogroups:null,fallback:p};y=!1,me&&(a=ft)}function et(s){for(;s!==null&&(s.f&bi)===0;)s=s.next;return s}function Vi(s,e,t,i,n){var U,ie,X,le,ce,ne,Z,de,z;var r=(i&wi)!==0,a=e.length,o=s.items,c=et(s.effect.first),m,p=null,b,f=[],y=[],k,P,v,_;if(r)for(_=0;_<a;_+=1)k=e[_],P=n(k,_),v=o.get(P).e,(v.f&Re)===0&&((ie=(U=v.nodes)==null?void 0:U.a)==null||ie.measure(),(b??(b=new Set)).add(v));for(_=0;_<a;_+=1){if(k=e[_],P=n(k,_),v=o.get(P).e,s.outrogroups!==null)for(const g of s.outrogroups)g.pending.delete(v),g.done.delete(v);if((v.f&Re)!==0)if(v.f^=Re,v===c)nt(v,null,t);else{var C=p?p.next:c;v===s.effect.last&&(s.effect.last=v.prev),v.prev&&(v.prev.next=v.next),v.next&&(v.next.prev=v.prev),Me(s,p,v),Me(s,v,C),nt(v,C,t),p=v,f=[],y=[],c=et(p.next);continue}if((v.f&Lt)!==0&&(Ls(v),r&&((le=(X=v.nodes)==null?void 0:X.a)==null||le.unfix(),(b??(b=new Set)).delete(v))),v!==c){if(m!==void 0&&m.has(v)){if(f.length<y.length){var H=y[0],E;p=H.prev;var N=f[0],T=f[f.length-1];for(E=0;E<f.length;E+=1)nt(f[E],H,t);for(E=0;E<y.length;E+=1)m.delete(y[E]);Me(s,N.prev,T.next),Me(s,p,N),Me(s,T,H),c=H,p=T,_-=1,f=[],y=[]}else m.delete(v),nt(v,c,t),Me(s,v.prev,v.next),Me(s,v,p===null?s.effect.first:p.next),Me(s,p,v),p=v;continue}for(f=[],y=[];c!==null&&c!==v;)(m??(m=new Set)).add(c),y.push(c),c=et(c.next);if(c===null)continue}(v.f&Re)===0&&f.push(v),p=v,c=et(v.next)}if(s.outrogroups!==null){for(const g of s.outrogroups)g.pending.size===0&&(Ft(es(g.done)),(ce=s.outrogroups)==null||ce.delete(g));s.outrogroups.size===0&&(s.outrogroups=null)}if(c!==null||m!==void 0){var S=[];if(m!==void 0)for(v of m)(v.f&Lt)===0&&S.push(v);for(;c!==null;)(c.f&Lt)===0&&c!==s.fallback&&S.push(c),c=et(c.next);var q=S.length;if(q>0){var L=(i&Os)!==0&&a===0?t:null;if(r){for(_=0;_<q;_+=1)(Z=(ne=S[_].nodes)==null?void 0:ne.a)==null||Z.measure();for(_=0;_<q;_+=1)(z=(de=S[_].nodes)==null?void 0:de.a)==null||z.fix()}Pi(s,S,L)}}r&&Bs(()=>{var g,M;if(b!==void 0)for(v of b)(M=(g=v.nodes)==null?void 0:g.a)==null||M.apply()})}function Ui(s,e,t,i,n,r,a,o){var c=(a&gi)!==0?(a&yi)===0?Y(t,!1,!1):vs(t):null,m=(a&mi)!==0?vs(n):null;return{v:c,i:m,e:Ht(()=>(r(e,c??t,m??n,o),()=>{s.delete(i)}))}}function nt(s,e,t){if(s.nodes)for(var i=s.nodes.start,n=s.nodes.end,r=e&&(e.f&Re)===0?e.nodes.start:t;i!==null;){var a=ki(i);if(r.before(i),i===n)return;i=a}}function Me(s,e,t){e===null?s.effect.first=t:e.next=t,t===null?s.effect.last=e:t.prev=e}const gs=[...` 	
\r\fÂ \v\uFEFF`];function qi(s,e,t){var i=s==null?"":""+s;if(e&&(i=i?i+" "+e:e),t){for(var n of Object.keys(t))if(t[n])i=i?i+" "+n:n;else if(i.length)for(var r=n.length,a=0;(a=i.indexOf(n,a))>=0;){var o=a+r;(a===0||gs.includes(i[a-1]))&&(o===i.length||gs.includes(i[o]))?i=(a===0?"":i.substring(0,a))+i.substring(o+1):a=o}}return i===""?null:i}function $i(s,e){return s==null?null:String(s)}function he(s,e,t,i,n,r){var a=s.__className;if(me||a!==t||a===void 0){var o=qi(t,i,r);(!me||o!==s.getAttribute("class"))&&(o==null?s.removeAttribute("class"):s.className=o),s.__className=t}else if(r&&n!==r)for(var c in r){var m=!!r[c];(n==null||m!==!!n[c])&&s.classList.toggle(c,m)}return r}function tt(s,e,t,i){var n=s.__style;if(me||n!==e){var r=$i(e);(!me||r!==s.getAttribute("style"))&&(r==null?s.removeAttribute("style"):s.style.cssText=r),s.__style=e}return i}function Kt(s,e,t=!1){if(s.multiple){if(e==null)return;if(!Ns(e))return Ti();for(var i of s.options)i.selected=e.includes(_s(i));return}for(i of s.options){var n=_s(i);if(Ci(n,e)){i.selected=!0;return}}(!t||e!==void 0)&&(s.selectedIndex=-1)}function ys(s){var e=new MutationObserver(()=>{Kt(s,s.__value)});e.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ai(()=>{e.disconnect()})}function _s(s){return"__value"in s?s.__value:s.value}const zi=Symbol("is custom element"),Hi=Symbol("is html"),Fi=Ds?"link":"LINK",Ki=Ds?"progress":"PROGRESS";function Ue(s){if(me){var e=!1,t=()=>{if(!e){if(e=!0,s.hasAttribute("value")){var i=s.value;ut(s,"value",null),s.value=i}if(s.hasAttribute("checked")){var n=s.checked;ut(s,"checked",null),s.checked=n}}};s.__on_r=t,Bs(t),Ni()}}function Mt(s,e){var t=is(s);t.value===(t.value=e??void 0)||s.value===e&&(e!==0||s.nodeName!==Ki)||(s.value=e??"")}function Yi(s,e){var t=is(s);t.checked!==(t.checked=e??void 0)&&(s.checked=e)}function ut(s,e,t,i){var n=is(s);me&&(n[e]=s.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&s.nodeName===Fi)||n[e]!==(n[e]=t)&&(e==="loading"&&(s[Oi]=t),t==null?s.removeAttribute(e):typeof t!="string"&&Wi(s).includes(e)?s[e]=t:s.setAttribute(e,t))}function is(s){return s.__attributes??(s.__attributes={[zi]:s.nodeName.includes("-"),[Hi]:s.namespaceURI===Ii})}var bs=new Map;function Wi(s){var e=s.getAttribute("is")||s.nodeName,t=bs.get(e);if(t)return t;bs.set(e,t=[]);for(var i,n=s,r=Element.prototype;r!==n;){i=xi(n);for(var a in i)i[a].set&&t.push(a);n=Ri(n)}return t}function Bt(s,e,t=e){var i=new WeakSet;Li(s,"input",async n=>{var r=n?s.defaultValue:s.value;if(r=Dt(s)?Pt(r):r,t(r),We!==null&&i.add(We),await Mi(),r!==(r=e())){var a=s.selectionStart,o=s.selectionEnd,c=s.value.length;if(s.value=r??"",o!==null){var m=s.value.length;a===o&&o===c&&m>c?(s.selectionStart=m,s.selectionEnd=m):(s.selectionStart=a,s.selectionEnd=Math.min(o,m))}}}),(me&&s.defaultValue!==s.value||x(e)==null&&s.value)&&(t(Dt(s)?Pt(s.value):s.value),We!==null&&i.add(We)),Bi(()=>{var n=e();if(s===document.activeElement){var r=Di??We;if(i.has(r))return}Dt(s)&&n===Pt(s.value)||s.type==="date"&&!n&&!s.value||n!==s.value&&(s.value=n??"")})}function Dt(s){var e=s.type;return e==="number"||e==="range"}function Pt(s){return s===""?null:+s}function Gi(){const{subscribe:s,set:e,update:t}=ht({conversationId:null,messages:[],isLoading:!1});return{subscribe:s,init(i){t(n=>({...n,conversationId:i}))},addMessage(i,n,r=[]){t(a=>({...a,messages:[...a.messages,{role:i,content:n,commands:r,timestamp:new Date().toISOString()}]}))},addStreamingMessage(){t(i=>({...i,messages:[...i.messages,{role:"assistant",content:"",commands:[],timestamp:new Date().toISOString(),streaming:!0}]}))},updateStreamingMessage(i){t(n=>{const r=[...n.messages],a=r.length-1;return a>=0&&r[a].streaming&&(r[a]={...r[a],content:i}),{...n,messages:r}})},completeStreamingMessage(i,n=[]){t(r=>{const a=[...r.messages],o=a.length-1;return o>=0&&a[o].streaming&&(a[o]={...a[o],content:i,commands:n,streaming:!1}),{...r,messages:a}})},updateLastAssistant(i){t(n=>{const r=[...n.messages];for(let a=r.length-1;a>=0;a--)if(r[a].role==="assistant"){r[a]={...r[a],content:i};break}return{...n,messages:r}})},setLoading(i){t(n=>({...n,isLoading:i}))},clear(){e({conversationId:null,messages:[],isLoading:!1})},loadMessages(i,n){e({conversationId:i,messages:n,isLoading:!1})}}}const ae=Gi();var Ji=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg>'),ji=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.17A7 7 0 0113 21.93V22h-2v-.07A7 7 0 013.17 16H2a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2zm0 7a5 5 0 00-5 5 5 5 0 005 5 5 5 0 005-5 5 5 0 00-5-5zm0 2a3 3 0 013 3 3 3 0 01-3 3 3 3 0 01-3-3 3 3 0 013-3z"></path></svg>'),Qi=B('<span class="time svelte-1e5n1dp"> </span>'),Xi=B('<span class="cmd-icon svelte-1e5n1dp">&#9748;</span>'),Zi=B('<span class="cmd-icon svelte-1e5n1dp">&#128240;</span>'),en=B('<span class="cmd-icon svelte-1e5n1dp">&#128279;</span>'),tn=B('<span class="cmd-icon svelte-1e5n1dp">&#9881;</span>'),sn=B('<div class="command-badge svelte-1e5n1dp"><!> <span> </span></div>'),nn=B('<div class="commands svelte-1e5n1dp"></div>'),rn=B('<div><div class="avatar svelte-1e5n1dp"><!></div> <div class="content-wrapper svelte-1e5n1dp"><div class="meta svelte-1e5n1dp"><span class="role-label svelte-1e5n1dp"> </span> <!></div> <div class="text svelte-1e5n1dp"> </div> <!></div></div>');function an(s,e){xe(e,!1);let t=Ve(e,"role",8,"user"),i=Ve(e,"content",8,""),n=Ve(e,"timestamp",8,""),r=Ve(e,"commands",24,()=>[]);function a(T){return T?new Date(T).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}Oe();var o=rn(),c=d(o),m=d(c);{var p=T=>{var S=Ji();A(T,S)},b=T=>{var S=ji();A(T,S)};F(m,T=>{t()==="user"?T(p):T(b,!1)})}h(c);var f=u(c,2),y=d(f),k=d(y),P=d(k,!0);h(k);var v=u(k,2);{var _=T=>{var S=Qi(),q=d(S,!0);h(S),j(L=>W(q,L),[()=>(ot(n()),x(()=>a(n())))]),A(T,S)};F(v,T=>{n()&&T(_)})}h(y);var C=u(y,2),H=d(C,!0);h(C);var E=u(C,2);{var N=T=>{var S=nn();Je(S,5,r,Tt,(q,L)=>{var U=sn(),ie=d(U);{var X=z=>{var g=Xi();A(z,g)},le=z=>{var g=Zi();A(z,g)},ce=z=>{var g=en();A(z,g)},ne=z=>{var g=tn();A(z,g)};F(ie,z=>{l(L),x(()=>l(L).type==="weather")?z(X):(l(L),x(()=>l(L).type==="news")?z(le,1):(l(L),x(()=>l(L).type==="open_url"||l(L).type==="search")?z(ce,2):z(ne,!1)))})}var Z=u(ie,2),de=d(Z,!0);h(Z),h(U),j(()=>W(de,(l(L),x(()=>l(L).message||l(L).type)))),A(q,U)}),h(S),A(T,S)};F(E,T=>{ot(r()),x(()=>r()&&r().length>0)&&T(N)})}h(f),h(o),j(()=>{he(o,1,`bubble ${t()??""}`,"svelte-1e5n1dp"),W(P,t()==="user"?"You":"NOVA"),W(H,i())}),A(s,o),Ne()}var on=B(`<div class="empty-state svelte-1jlre7m"><div class="logo-ring svelte-1jlre7m"><div class="inner-ring svelte-1jlre7m"></div> <svg viewBox="0 0 24 24" fill="currentColor" width="40" height="40" class="svelte-1jlre7m"><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.17A7 7 0 0113 21.93V22h-2v-.07A7 7 0 013.17 16H2a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2zm0 7a5 5 0 00-5 5 5 5 0 005 5 5 5 0 005-5 5 5 0 00-5-5z" class="svelte-1jlre7m"></path></svg></div> <h2 class="svelte-1jlre7m">NOVA</h2> <p class="svelte-1jlre7m">Your AI Voice Assistant</p> <div class="suggestions svelte-1jlre7m"><span class="svelte-1jlre7m">"What's the weather today?"</span> <span class="svelte-1jlre7m">"Search for latest tech news"</span> <span class="svelte-1jlre7m">"Open YouTube"</span> <span class="svelte-1jlre7m">"Tell me a fun fact"</span></div></div>`),ln=B('<div class="typing-indicator svelte-1jlre7m"><div class="avatar-small svelte-1jlre7m"><svg viewBox="0 0 24 24" fill="currentColor" width="14" height="14" class="svelte-1jlre7m"><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.17A7 7 0 0113 21.93V22h-2v-.07A7 7 0 013.17 16H2a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z" class="svelte-1jlre7m"></path></svg></div> <div class="dots svelte-1jlre7m"><span class="svelte-1jlre7m"></span><span class="svelte-1jlre7m"></span><span class="svelte-1jlre7m"></span></div></div>'),cn=B("<!> <!>",1),un=B('<div class="chat-window svelte-1jlre7m"><!></div>');function hn(s,e){xe(e,!1);const t=()=>Ee(ae,"$conversation",i),[i,n]=He();let r=Y(),a=!0;ai(()=>{a&&l(r)&&Ps(r,l(r).scrollTop=l(r).scrollHeight)});function o(){if(!l(r))return;const{scrollTop:f,scrollHeight:y,clientHeight:k}=l(r);a=y-f-k<100}Oe();var c=un(),m=d(c);{var p=f=>{var y=on();A(f,y)},b=f=>{var y=cn(),k=ct(y);Je(k,1,()=>t().messages,Tt,(_,C)=>{an(_,{get role(){return l(C).role},get content(){return l(C).content},get timestamp(){return l(C).timestamp},get commands(){return l(C).commands}})});var P=u(k,2);{var v=_=>{var C=ln();A(_,C)};F(P,_=>{t().isLoading&&_(v)})}A(f,y)};F(m,f=>{t().messages.length===0?f(p):f(b,!1)})}h(c),At(c,f=>$(r,f),()=>l(r)),se("scroll",c,o),A(s,c),Ne(),n()}function dn(){const{subscribe:s,update:e}=ht({isListening:!1,isSpeaking:!1,interimTranscript:"",volume:0,error:null,supported:!0});return{subscribe:s,setListening(t){e(i=>({...i,isListening:t,error:null}))},setSpeaking(t){e(i=>({...i,isSpeaking:t}))},setInterim(t){e(i=>({...i,interimTranscript:t}))},setVolume(t){e(i=>({...i,volume:t}))},setError(t){e(i=>({...i,error:t,isListening:!1}))},setSupported(t){e(i=>({...i,supported:t}))}}}const G=dn(),Yt="nova-settings";function fn(){if(typeof localStorage>"u")return{};try{const s=localStorage.getItem(Yt);return s?JSON.parse(s):{}}catch{return{}}}const ws={autoSpeak:!0,voiceName:"",speechRate:.95,speechPitch:.85,speechVolume:1,language:"en-GB",continuousListening:!0,cameraEnabled:!1,showSettings:!1};function vn(){const s={...ws,...fn()},{subscribe:e,update:t,set:i}=ht(s);function n(r){if(typeof localStorage<"u"){const{showSettings:a,...o}=r;localStorage.setItem(Yt,JSON.stringify(o))}}return{subscribe:e,update(r,a){t(o=>{const c={...o,[r]:a};return n(c),c})},toggleSettings(){t(r=>({...r,showSettings:!r.showSettings}))},reset(){i({...ws}),typeof localStorage<"u"&&localStorage.removeItem(Yt)}}}const ue=vn();let re=null,qe=null,st=null,je=null,yt=null,Wt=!1,Vt=null,Ut=null,_t=!1;function pn(){return!!(typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition))}function mn(s={}){if(!pn())return G.setSupported(!1),null;const e=window.SpeechRecognition||window.webkitSpeechRecognition;return re=new e,re.continuous=!0,re.interimResults=!0,re.lang=s.lang||"en-US",re.maxAlternatives=1,re}async function Vs(s,e,t="en-US"){if(re||mn({lang:t}),!!re){Vt=s,Ut=e,_t=!0,Wt=!0,re.lang=t,re.onresult=i=>{let n="",r="";for(let a=i.resultIndex;a<i.results.length;a++){const o=i.results[a][0].transcript;i.results[a].isFinal?r+=o:n+=o}G.setInterim(n||r),r&&Vt&&Vt(r.trim())},re.onerror=i=>{i.error==="no-speech"||i.error==="aborted"||(G.setError(i.error),Ut&&Ut(i.error))},re.onend=()=>{if(G.setInterim(""),_t&&Wt)try{setTimeout(()=>{_t&&re&&re.start()},100)}catch{}else G.setListening(!1),qs()};try{re.start(),G.setListening(!0),await gn()}catch(i){G.setError(i.message)}}}function Us(){if(_t=!1,Wt=!1,re)try{re.stop()}catch{}G.setListening(!1),G.setInterim(""),qs()}async function gn(){if(!(qe&&je))try{qe=new(window.AudioContext||window.webkitAudioContext),je=await navigator.mediaDevices.getUserMedia({audio:!0});const s=qe.createMediaStreamSource(je);st=qe.createAnalyser(),st.fftSize=256,s.connect(st);const e=new Uint8Array(st.frequencyBinCount);yt=setInterval(()=>{st.getByteFrequencyData(e);let t=0;for(let n=0;n<e.length;n++)t+=e[n];const i=t/e.length/255;G.setVolume(i)},50)}catch{}}function qs(){yt&&(clearInterval(yt),yt=null),je&&(je.getTracks().forEach(s=>s.stop()),je=null),qe&&(qe.close().catch(()=>{}),qe=null),G.setVolume(0)}const yn=["Google UK English Male","Microsoft Ryan","Microsoft George","Daniel","James","Google UK English","English United Kingdom","en-GB","Male"];function ns(){return!!(typeof window<"u"&&window.speechSynthesis)}function rs(){return ns()?window.speechSynthesis.getVoices():[]}function _n(){const s=rs();if(!s.length)return null;for(const e of yn){const t=s.find(i=>i.name.includes(e)||i.lang.includes(e));if(t)return t}return s.find(e=>e.lang.startsWith("en"))||s[0]}function $s(s,e={}){if(!ns()||!s)return;zs();const t=new SpeechSynthesisUtterance(s);if(t.rate=e.rate??.95,t.pitch=e.pitch??.85,t.volume=e.volume??1,t.lang=e.lang||"en-GB",e.voiceName){const n=rs().find(r=>r.name===e.voiceName);n&&(t.voice=n)}else{const i=_n();i&&(t.voice=i)}t.onstart=()=>G.setSpeaking(!0),t.onend=()=>G.setSpeaking(!1),t.onerror=()=>G.setSpeaking(!1),window.speechSynthesis.speak(t)}function zs(){ns()&&window.speechSynthesis.cancel(),G.setSpeaking(!1)}class bn{constructor(){this.isSpacePressed=!1,this.isAIResponding=!1,this.isContinuousMode=!1,this.speechQueue=[],this.isSpeaking=!1,this.interruptThreshold=.3,this.interruptionTimeout=null,this.pushToTalkKey=" "}async start(){var e;if(!this.isContinuousMode){this.isContinuousMode=!0;try{await Vs(t=>this.handleVoiceInput(t),t=>this.handleVoiceError(t),((e=ue.get())==null?void 0:e.language)||"en-US")}catch(t){console.error("Failed to start voice recognition:",t),this.isContinuousMode=!1;return}this.addKeyboardListeners(),this.addInterruptionDetection()}}stop(){this.isContinuousMode=!1,this.isSpacePressed=!1,this.isAIResponding=!1,Us(),this.removeKeyboardListeners(),this.removeInterruptionDetection(),this.clearInterruptionTimeout()}handleVoiceInput(e){var t;!e.trim()||!this.isContinuousMode||(console.log("Voice input detected:",e),this.isAIResponding&&(console.log("Interrupting AI response"),this.interruptAIResponse()),(t=this.onUserMessage)==null||t.call(this,e.trim()))}handleVoiceError(e){console.warn("Voice recognition error:",e),this.isContinuousMode&&setTimeout(()=>{this.isContinuousMode&&this.start()},1e3)}addKeyboardListeners(){this.keyDownHandler=e=>{e.key===this.pushToTalkKey&&!e.repeat&&(this.isSpacePressed=!0,G.setListening(!0),e.preventDefault())},this.keyUpHandler=e=>{e.key===this.pushToTalkKey&&(this.isSpacePressed=!1,e.preventDefault())},window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler)}removeKeyboardListeners(){this.keyDownHandler&&(window.removeEventListener("keydown",this.keyDownHandler),this.keyDownHandler=null),this.keyUpHandler&&(window.removeEventListener("keyup",this.keyUpHandler),this.keyUpHandler=null)}addInterruptionDetection(){this.unsubscribe=G.subscribe(e=>{this.isAIResponding&&e.volume>this.interruptThreshold&&this.handleInterruption()})}removeInterruptionDetection(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}handleInterruption(){this.interruptionTimeout&&clearTimeout(this.interruptionTimeout),this.interruptionTimeout=setTimeout(()=>{this.isAIResponding&&this.interruptAIResponse()},300)}clearInterruptionTimeout(){this.interruptionTimeout&&(clearTimeout(this.interruptionTimeout),this.interruptionTimeout=null)}interruptAIResponse(){var e;console.log("Interrupting AI response..."),this.clearInterruptionTimeout(),zs(),this.isAIResponding=!1,this.speechQueue=[],this.isSpeaking=!1,(e=this.onInterruption)==null||e.call(this)}startAIResponse(){this.isAIResponding=!0,this.clearInterruptionTimeout()}endAIResponse(){this.isAIResponding=!1,this.clearInterruptionTimeout()}queueSpeech(e){e.trim()&&(this.speechQueue.push(e),this.isSpeaking||this.processSpeechQueue())}processSpeechQueue(){if(this.speechQueue.length===0){this.isSpeaking=!1;return}if(this.isAIResponding===!1){this.speechQueue=[],this.isSpeaking=!1;return}this.isSpeaking=!0;const e=this.speechQueue.shift(),t=ue.get();$s(e,{rate:(t==null?void 0:t.speechRate)??.95,pitch:(t==null?void 0:t.speechPitch)??.85,volume:(t==null?void 0:t.speechVolume)??1,voiceName:(t==null?void 0:t.voiceName)??"",lang:(t==null?void 0:t.language)??"en-US"}),setTimeout(()=>{const i=()=>{window.speechSynthesis.speaking?setTimeout(i,100):(this.isSpeaking=!1,this.processSpeechQueue())};setTimeout(i,300)},100)}onUserMessage(e){this.onUserMessage=e}onInterruption(e){this.onInterruption=e}isActive(){return this.isContinuousMode}isPushToTalkActive(){return this.isSpacePressed}}const oe=new bn;var wn=B('<div class="continuous-indicator svelte-mqozx4"><span class="indicator-dot svelte-mqozx4"></span> <span class="indicator-text svelte-mqozx4"><!></span></div>'),Sn=B('<div class="interim svelte-mqozx4"><span class="interim-dot svelte-mqozx4"></span> <span class="interim-text svelte-mqozx4"> </span></div>'),En=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24" class="svelte-mqozx4"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z" class="svelte-mqozx4"></path><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z" class="svelte-mqozx4"></path></svg>'),kn=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24" class="svelte-mqozx4"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" class="svelte-mqozx4"></path></svg>'),An=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24" class="svelte-mqozx4"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z" class="svelte-mqozx4"></path><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z" class="svelte-mqozx4"></path></svg>'),Tn=B('<div class="listening-badge svelte-mqozx4"><span class="pulse-dot svelte-mqozx4"></span> ALWAYS LISTENING</div>'),Cn=B('<div class="warning svelte-mqozx4">Voice not supported in this browser. Use Chrome or Edge.</div>'),In=B('<div class="error-msg svelte-mqozx4"> </div>'),Rn=B('<div class="voice-controls svelte-mqozx4"><!> <!> <div class="controls-row svelte-mqozx4"><button><div></div> <div></div> <div></div> <div class="mic-inner svelte-mqozx4"><!></div></button> <!></div> <!> <!></div>');function xn(s,e){xe(e,!1);const t=()=>Ee(G,"$voice",n),i=()=>Ee(ue,"$settings",n),[n,r]=He();let a=Ve(e,"onResult",8,()=>{}),o=Ve(e,"disabled",8,!1);function c(){o()||oe.isActive()||(t().isListening?Us():Vs(g=>a()(g),g=>console.error("STT error:",g),i().language))}Oe();var m=Rn(),p=d(m);{var b=g=>{var M=wn(),ee=u(d(M),2),_e=d(ee);{var fe=te=>{var ve=hs("PUSH-TO-TALK ACTIVE (HOLD SPACE)");A(te,ve)},be=ps(()=>(ot(oe),x(()=>oe.isPushToTalkActive()))),ge=te=>{var ve=hs("CONTINUOUS LISTENING");A(te,ve)};F(_e,te=>{l(be)?te(fe):te(ge,!1)})}h(ee),h(M),A(g,M)},f=ps(()=>(ot(oe),x(()=>oe.isActive())));F(p,g=>{l(f)&&g(b)})}var y=u(p,2);{var k=g=>{var M=Sn(),ee=u(d(M),2),_e=d(ee,!0);h(ee),h(M),j(()=>W(_e,(t(),x(()=>t().interimTranscript)))),A(g,M)};F(y,g=>{t(),x(()=>t().interimTranscript)&&g(k)})}var P=u(y,2),v=d(P);let _;var C=d(v);let H;var E=u(C,2);let N;var T=u(E,2);let S;var q=u(T,2),L=d(q);{var U=g=>{var M=En();A(g,M)},ie=g=>{var M=kn();A(g,M)},X=g=>{var M=An();A(g,M)};F(L,g=>{t(),x(()=>t().isListening)?g(U):(t(),x(()=>t().isSpeaking)?g(ie,1):g(X,!1))})}h(q),h(v);var le=u(v,2);{var ce=g=>{var M=Tn();A(g,M)};F(le,g=>{t(),x(()=>t().isListening)&&g(ce)})}h(P);var ne=u(P,2);{var Z=g=>{var M=Cn();A(g,M)};F(ne,g=>{t(),x(()=>!t().supported)&&g(Z)})}var de=u(ne,2);{var z=g=>{var M=In(),ee=d(M,!0);h(M),j(()=>W(ee,(t(),x(()=>t().error)))),A(g,M)};F(de,g=>{t(),x(()=>t().error)&&g(z)})}h(m),j((g,M)=>{_=he(v,1,"mic-button svelte-mqozx4",null,_,g),ut(v,"title",M),H=he(C,1,"mic-ring ring-1 svelte-mqozx4",null,H,{active:t().isListening}),N=he(E,1,"mic-ring ring-2 svelte-mqozx4",null,N,{active:t().isListening}),S=he(T,1,"mic-ring ring-3 svelte-mqozx4",null,S,{active:t().isListening})},[()=>({listening:t().isListening,speaking:t().isSpeaking,disabled:o()||oe.isActive()}),()=>(ot(oe),t(),x(()=>oe.isActive()?"Continuous mode active - use spacebar":t().isListening?"Stop listening":"Start listening"))]),se("click",v,c),A(s,m),Ne(),r()}var Nn=B('<div><canvas width="400" height="60" class="svelte-lmximv"></canvas></div>');function On(s,e){xe(e,!1);const t=()=>Ee(G,"$voice",i),[i,n]=He();let r=Y(),a,o=Array(32).fill(0);function c(){const f=l(r).getContext("2d"),y=l(r).width,k=l(r).height,P=32,v=y/P-2;function _(){f.clearRect(0,0,y,k);for(let C=0;C<P;C++){let H;if(t().isListening){const q=t().volume,L=Math.sin(Date.now()/200+C*.3)*.5+.5;H=(q*.7+L*.3)*k*.8+4}else if(t().isSpeaking){const q=Math.sin(Date.now()/150+C*.4)*.5+.5,L=Math.sin(Date.now()/300)*.3+.7;H=q*L*k*.5+4}else H=(Math.sin(Date.now()/800+C*.2)*.1+.1)*k+2;o[C]+=(H-o[C])*.15;const E=C*(v+2),N=o[C],T=(k-N)/2,S=f.createLinearGradient(E,T,E,T+N);t().isListening?(S.addColorStop(0,"rgba(255, 82, 82, 0.9)"),S.addColorStop(1,"rgba(255, 82, 82, 0.3)")):t().isSpeaking?(S.addColorStop(0,"rgba(108, 99, 255, 0.9)"),S.addColorStop(1,"rgba(168, 99, 255, 0.3)")):(S.addColorStop(0,"rgba(255, 255, 255, 0.15)"),S.addColorStop(1,"rgba(255, 255, 255, 0.05)")),f.fillStyle=S,f.beginPath(),f.roundRect(E,T,v,N,2),f.fill()}a=requestAnimationFrame(_)}a&&cancelAnimationFrame(a),_()}lt(()=>{a&&cancelAnimationFrame(a)}),Ge(()=>l(r),()=>{l(r)&&c()}),ts(),Oe();var m=Nn();let p;var b=d(m);At(b,f=>$(r,f),()=>l(r)),h(m),j(()=>p=he(m,1,"waveform-container svelte-lmximv",null,p,{active:t().isListening||t().isSpeaking})),A(s,m),Ne(),n()}var Ln=B('<option class="svelte-d580bl"> </option>'),Mn=B('<div class="overlay svelte-d580bl" role="button" tabindex="-1" aria-label="Close settings"></div> <div class="panel svelte-d580bl"><div class="panel-header svelte-d580bl"><h3 class="svelte-d580bl">Settings</h3> <button class="close-btn svelte-d580bl" aria-label="Close settings"><svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button></div> <div class="section svelte-d580bl"><h4 class="svelte-d580bl">Voice Output</h4> <label class="toggle-row svelte-d580bl"><span class="svelte-d580bl">Auto-speak responses</span> <input type="checkbox" class="svelte-d580bl"/></label> <label class="field svelte-d580bl"><span class="svelte-d580bl">Voice</span> <select class="svelte-d580bl"><option class="svelte-d580bl">Auto (Jarvis-like)</option><!></select></label> <label class="field svelte-d580bl"><span class="svelte-d580bl"> </span> <input type="range" min="0.5" max="2" step="0.1" class="svelte-d580bl"/></label> <label class="field svelte-d580bl"><span class="svelte-d580bl"> </span> <input type="range" min="0.5" max="2" step="0.1" class="svelte-d580bl"/></label> <label class="field svelte-d580bl"><span class="svelte-d580bl"> </span> <input type="range" min="0" max="1" step="0.1" class="svelte-d580bl"/></label></div> <div class="section svelte-d580bl"><h4 class="svelte-d580bl">Speech Input</h4> <label class="field svelte-d580bl"><span class="svelte-d580bl">Language</span> <select class="svelte-d580bl"><option class="svelte-d580bl">English (UK) - Jarvis default</option><option class="svelte-d580bl">English (US)</option><option class="svelte-d580bl">Hindi</option><option class="svelte-d580bl">Spanish</option><option class="svelte-d580bl">French</option><option class="svelte-d580bl">German</option><option class="svelte-d580bl">Japanese</option></select></label> <div class="info-box svelte-d580bl">Mic runs in <strong class="svelte-d580bl">continuous mode</strong> - it keeps listening until you manually click the mic button to stop.</div></div> <div class="section svelte-d580bl"><h4 class="svelte-d580bl">Camera / Vision</h4> <div class="info-box svelte-d580bl">When camera is enabled, N.O.V.A. can see you through your webcam. It sends a snapshot with each message to an Ollama vision model (llava). Toggle the camera from the main screen.</div></div> <div class="section svelte-d580bl"><button class="reset-btn svelte-d580bl">Reset to defaults</button></div></div>',1);function Bn(s,e){xe(e,!1);const t=()=>Ee(ue,"$settings",i),[i,n]=He();let r=Y([]);kt(()=>{var b;a(),typeof window<"u"&&((b=window.speechSynthesis)==null||b.addEventListener("voiceschanged",a))});function a(){$(r,rs())}function o(){ue.toggleSettings()}Oe();var c=ri(),m=ct(c);{var p=b=>{var f=Mn(),y=ct(f),k=u(y,2),P=d(k),v=u(d(P),2);h(P);var _=u(P,2),C=u(d(_),2),H=u(d(C),2);Ue(H),h(C);var E=u(C,2),N=u(d(E),2),T=d(N);T.value=T.__value="";var S=u(T);Je(S,1,()=>l(r),Tt,(V,K)=>{var I=Ln(),R=d(I);h(I);var O={};j(()=>{W(R,`${l(K).name??""} (${l(K).lang??""})`),O!==(O=l(K).name)&&(I.value=(I.__value=l(K).name)??"")}),A(V,I)}),h(N);var q;ys(N),h(E);var L=u(E,2),U=d(L),ie=d(U);h(U);var X=u(U,2);Ue(X),h(L);var le=u(L,2),ce=d(le),ne=d(ce);h(ce);var Z=u(ce,2);Ue(Z),h(le);var de=u(le,2),z=d(de),g=d(z);h(z);var M=u(z,2);Ue(M),h(de),h(_);var ee=u(_,2),_e=u(d(ee),2),fe=u(d(_e),2),be=d(fe);be.value=be.__value="en-GB";var ge=u(be);ge.value=ge.__value="en-US";var te=u(ge);te.value=te.__value="hi-IN";var ve=u(te);ve.value=ve.__value="es-ES";var De=u(ve);De.value=De.__value="fr-FR";var Ce=u(De);Ce.value=Ce.__value="de-DE";var Pe=u(Ce);Pe.value=Pe.__value="ja-JP",h(fe);var Le;ys(fe),h(_e),ss(2),h(ee);var Fe=u(ee,4),w=d(Fe);h(Fe),h(k),j((V,K,I)=>{Yi(H,t().autoSpeak),q!==(q=t().voiceName)&&(N.value=(N.__value=t().voiceName)??"",Kt(N,t().voiceName)),W(ie,`Speed: ${V??""}x`),Mt(X,t().speechRate),W(ne,`Pitch: ${K??""}`),Mt(Z,t().speechPitch),W(g,`Volume: ${I??""}%`),Mt(M,t().speechVolume),Le!==(Le=t().language)&&(fe.value=(fe.__value=t().language)??"",Kt(fe,t().language))},[()=>t().speechRate.toFixed(1),()=>t().speechPitch.toFixed(1),()=>Math.round(t().speechVolume*100)]),se("click",y,o),se("keydown",y,o),se("click",v,o),se("change",H,V=>ue.update("autoSpeak",V.target.checked)),se("change",N,V=>ue.update("voiceName",V.target.value)),se("input",X,V=>ue.update("speechRate",parseFloat(V.target.value))),se("input",Z,V=>ue.update("speechPitch",parseFloat(V.target.value))),se("input",M,V=>ue.update("speechVolume",parseFloat(V.target.value))),se("change",fe,V=>ue.update("language",V.target.value)),se("click",w,()=>ue.reset()),A(b,f)};F(m,b=>{t().showSettings&&b(p)})}A(s,c),Ne(),n()}const Dn="/api";async function Hs(s,e={}){const t=await fetch(`${Dn}${s}`,{headers:{"Content-Type":"application/json"},...e});if(!t.ok){const i=await t.json().catch(()=>({error:t.statusText}));throw new Error(i.error||"Request failed")}return t.json()}async function Pn(){return Hs("/health")}async function Vn(s,e){return Hs("/users/register",{method:"POST",body:JSON.stringify({name:s,email:e})})}var Un=B('<div class="model-badge svelte-193vlpn"> </div>'),qn=B('<div class="status-bar svelte-193vlpn"><div><span class="dot svelte-193vlpn"></span> <span>Server</span></div> <div><span class="dot svelte-193vlpn"></span> <span>Ollama</span></div> <!></div>');function $n(s,e){xe(e,!1);let t=Y({server:!1,ollama:!1,model:""}),i=Y(!0);kt(()=>{n();const f=setInterval(n,3e4);return()=>clearInterval(f)});async function n(){var f,y,k;$(i,!0);try{const P=await Pn();$(t,{server:!0,ollama:((f=P.ollama)==null?void 0:f.running)||!1,model:((k=(y=P.ollama)==null?void 0:y.models)==null?void 0:k[0])||""})}catch{$(t,{server:!1,ollama:!1,model:""})}$(i,!1)}Oe();var r=qn(),a=d(r);let o;var c=u(a,2);let m;var p=u(c,2);{var b=f=>{var y=Un(),k=d(y,!0);h(y),j(()=>W(k,l(t).model)),A(f,y)};F(p,f=>{l(t).model&&f(b)})}h(r),j(()=>{o=he(a,1,"indicator svelte-193vlpn",null,o,{ok:l(t).server,error:!l(t).server&&!l(i)}),m=he(c,1,"indicator svelte-193vlpn",null,m,{ok:l(t).ollama,error:!l(t).ollama&&!l(i)})}),A(s,r),Ne()}function zn(){const{subscribe:s,update:e}=ht({enabled:!1,stream:null,hasPermission:!1,error:null});return{subscribe:s,setEnabled(t){e(i=>({...i,enabled:t}))},setStream(t){e(i=>({...i,stream:t,hasPermission:!!t}))},setError(t){e(i=>({...i,error:t}))}}}const $e=zn();let Qe=null;async function Hn(){try{return Qe=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:640},height:{ideal:480}}}),$e.setStream(Qe),$e.setEnabled(!0),Qe}catch{return $e.setError("Camera access denied. Please allow camera permissions."),null}}function Ss(){Qe&&(Qe.getTracks().forEach(s=>s.stop()),Qe=null),$e.setStream(null),$e.setEnabled(!1)}function Fn(s){if(!s||s.readyState<2)return null;const e=document.createElement("canvas");return e.width=s.videoWidth||640,e.height=s.videoHeight||480,e.getContext("2d").drawImage(s,0,0,e.width,e.height),e.toDataURL("image/jpeg",.7).split(",")[1]}var Kn=B('<video autoplay="" playsinline="" class="camera-feed svelte-1auw75p"></video> <div class="camera-overlay svelte-1auw75p"><div class="scan-line svelte-1auw75p"></div> <div class="corner tl svelte-1auw75p"></div> <div class="corner tr svelte-1auw75p"></div> <div class="corner bl svelte-1auw75p"></div> <div class="corner br svelte-1auw75p"></div> <span class="camera-label svelte-1auw75p">LIVE</span></div>',3),Yn=B('<div class="camera-off svelte-1auw75p"><svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24" class="svelte-1auw75p"><path d="M18 10.48V6c0-1.1-.9-2-2-2H6.83l2 2H16v7.17l2 2v-4.69zm-1.41 9.93l1.41-1.41L3.41 4.41 2 5.82l1 1V18c0 1.1.9 2 2 2h12.17l1.42 1.41zM5 18V8.83L13.17 17H5z" class="svelte-1auw75p"></path></svg> <span class="svelte-1auw75p">Camera Off</span></div>'),Wn=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16" class="svelte-1auw75p"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z" class="svelte-1auw75p"></path></svg>'),Gn=ze('<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16" class="svelte-1auw75p"><path d="M18 10.48V6c0-1.1-.9-2-2-2H6.83l2 2H16v7.17l2 2v-4.69zm-1.41 9.93l1.41-1.41L3.41 4.41 2 5.82l1 1V18c0 1.1.9 2 2 2h12.17l1.42 1.41zM5 18V8.83L13.17 17H5z" class="svelte-1auw75p"></path></svg>'),Jn=B('<div class="camera-error svelte-1auw75p"> </div>'),jn=B("<div><!> <button><!></button> <!></div>");function Es(s,e){xe(e,!1);const t=()=>Ee($e,"$camera",i),[i,n]=He();let r=Ve(e,"compact",8,!1),a=Y();lt(()=>{Ss()});async function o(){t().enabled?Ss():await Hn()}Ge(()=>(l(a),t()),()=>{l(a)&&t().stream&&Ps(a,l(a).srcObject=t().stream)}),ts(),Oe();var c=jn();let m;var p=d(c);{var b=E=>{var N=Kn(),T=ct(N);T.muted=!0,At(T,S=>$(a,S),()=>l(a)),ss(2),A(E,N)},f=E=>{var N=Yn();A(E,N)};F(p,E=>{t(),x(()=>t().enabled)?E(b):E(f,!1)})}var y=u(p,2);let k;var P=d(y);{var v=E=>{var N=Wn();A(E,N)},_=E=>{var N=Gn();A(E,N)};F(P,E=>{t(),x(()=>t().enabled)?E(v):E(_,!1)})}h(y);var C=u(y,2);{var H=E=>{var N=Jn(),T=d(N,!0);h(N),j(()=>W(T,(t(),x(()=>t().error)))),A(E,N)};F(C,E=>{t(),x(()=>t().error)&&E(H)})}h(c),j(()=>{m=he(c,1,"camera-wrapper svelte-1auw75p",null,m,{compact:r(),active:t().enabled}),k=he(y,1,"camera-toggle svelte-1auw75p",null,k,{on:t().enabled}),ut(y,"title",(t(),x(()=>t().enabled?"Disable camera":"Enable camera"))),ut(y,"aria-label",(t(),x(()=>t().enabled?"Disable camera":"Enable camera")))}),se("click",y,o),A(s,c),Ne(),n()}const Te=Object.create(null);Te.open="0";Te.close="1";Te.ping="2";Te.pong="3";Te.message="4";Te.upgrade="5";Te.noop="6";const bt=Object.create(null);Object.keys(Te).forEach(s=>{bt[Te[s]]=s});const Gt={type:"error",data:"parser error"},Fs=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ks=typeof ArrayBuffer=="function",Ys=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,as=({type:s,data:e},t,i)=>Fs&&e instanceof Blob?t?i(e):ks(e,i):Ks&&(e instanceof ArrayBuffer||Ys(e))?t?i(e):ks(new Blob([e]),i):i(Te[s]+(e||"")),ks=(s,e)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];e("b"+(i||""))},t.readAsDataURL(s)};function As(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let qt;function Qn(s,e){if(Fs&&s.data instanceof Blob)return s.data.arrayBuffer().then(As).then(e);if(Ks&&(s.data instanceof ArrayBuffer||Ys(s.data)))return e(As(s.data));as(s,!1,t=>{qt||(qt=new TextEncoder),e(qt.encode(t))})}const Ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Ts.length;s++)rt[Ts.charCodeAt(s)]=s;const Xn=s=>{let e=s.length*.75,t=s.length,i,n=0,r,a,o,c;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const m=new ArrayBuffer(e),p=new Uint8Array(m);for(i=0;i<t;i+=4)r=rt[s.charCodeAt(i)],a=rt[s.charCodeAt(i+1)],o=rt[s.charCodeAt(i+2)],c=rt[s.charCodeAt(i+3)],p[n++]=r<<2|a>>4,p[n++]=(a&15)<<4|o>>2,p[n++]=(o&3)<<6|c&63;return m},Zn=typeof ArrayBuffer=="function",os=(s,e)=>{if(typeof s!="string")return{type:"message",data:Ws(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:er(s.substring(1),e)}:bt[t]?s.length>1?{type:bt[t],data:s.substring(1)}:{type:bt[t]}:Gt},er=(s,e)=>{if(Zn){const t=Xn(s);return Ws(t,e)}else return{base64:!0,data:s}},Ws=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},Gs="",tr=(s,e)=>{const t=s.length,i=new Array(t);let n=0;s.forEach((r,a)=>{as(r,!1,o=>{i[a]=o,++n===t&&e(i.join(Gs))})})},sr=(s,e)=>{const t=s.split(Gs),i=[];for(let n=0;n<t.length;n++){const r=os(t[n],e);if(i.push(r),r.type==="error")break}return i};function ir(){return new TransformStream({transform(s,e){Qn(s,t=>{const i=t.length;let n;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);const r=new DataView(n.buffer);r.setUint8(0,126),r.setUint16(1,i)}else{n=new Uint8Array(9);const r=new DataView(n.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(t)})}})}let $t;function vt(s){return s.reduce((e,t)=>e+t.length,0)}function pt(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let i=0;for(let n=0;n<e;n++)t[n]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),t}function nr(s,e){$t||($t=new TextDecoder);const t=[];let i=0,n=-1,r=!1;return new TransformStream({transform(a,o){for(t.push(a);;){if(i===0){if(vt(t)<1)break;const c=pt(t,1);r=(c[0]&128)===128,n=c[0]&127,n<126?i=3:n===126?i=1:i=2}else if(i===1){if(vt(t)<2)break;const c=pt(t,2);n=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),i=3}else if(i===2){if(vt(t)<8)break;const c=pt(t,8),m=new DataView(c.buffer,c.byteOffset,c.length),p=m.getUint32(0);if(p>Math.pow(2,21)-1){o.enqueue(Gt);break}n=p*Math.pow(2,32)+m.getUint32(4),i=3}else{if(vt(t)<n)break;const c=pt(t,n);o.enqueue(os(r?c:$t.decode(c),e)),i=0}if(n===0||n>s){o.enqueue(Gt);break}}}})}const Js=4;function Q(s){if(s)return rr(s)}function rr(s){for(var e in Q.prototype)s[e]=Q.prototype[e];return s}Q.prototype.on=Q.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};Q.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};Q.prototype.off=Q.prototype.removeListener=Q.prototype.removeAllListeners=Q.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+s],this};Q.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};Q.prototype.emitReserved=Q.prototype.emit;Q.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Q.prototype.hasListeners=function(s){return!!this.listeners(s).length};const Ct=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ye=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ar="arraybuffer";function js(s,...e){return e.reduce((t,i)=>(s.hasOwnProperty(i)&&(t[i]=s[i]),t),{})}const or=ye.setTimeout,lr=ye.clearTimeout;function It(s,e){e.useNativeTimers?(s.setTimeoutFn=or.bind(ye),s.clearTimeoutFn=lr.bind(ye)):(s.setTimeoutFn=ye.setTimeout.bind(ye),s.clearTimeoutFn=ye.clearTimeout.bind(ye))}const cr=1.33;function ur(s){return typeof s=="string"?hr(s):Math.ceil((s.byteLength||s.size)*cr)}function hr(s){let e=0,t=0;for(let i=0,n=s.length;i<n;i++)e=s.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}function Qs(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function dr(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function fr(s){let e={},t=s.split("&");for(let i=0,n=t.length;i<n;i++){let r=t[i].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class vr extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}class ls extends Q{constructor(e){super(),this.writable=!1,It(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,i){return super.emitReserved("error",new vr(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=os(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=dr(e);return t.length?"?"+t:""}}class pr extends ls{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};sr(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,tr(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Qs()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Xs=!1;try{Xs=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const mr=Xs;function gr(){}class yr extends pr{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let i=location.port;i||(i=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,t){const i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(n,r)=>{this.onError("xhr post error",n,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}}class Ae extends Q{constructor(e,t,i){super(),this.createRequest=e,It(this,i),this._opts=i,this._method=i.method||"GET",this._uri=t,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const t=js(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(t);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&i.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var n;i.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=Ae.requestsCount++,Ae.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=gr,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ae.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ae.requestsCount=0;Ae.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Cs);else if(typeof addEventListener=="function"){const s="onpagehide"in ye?"pagehide":"unload";addEventListener(s,Cs,!1)}}function Cs(){for(let s in Ae.requests)Ae.requests.hasOwnProperty(s)&&Ae.requests[s].abort()}const _r=(function(){const s=Zs({xdomain:!1});return s&&s.responseType!==null})();class br extends yr{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=_r&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Ae(Zs,this.uri(),e)}}function Zs(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||mr))return new XMLHttpRequest}catch{}if(!e)try{return new ye[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ei=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class wr extends ls{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,i=ei?{}:js(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],n=t===e.length-1;as(i,this.supportsBinary,r=>{try{this.doWrite(i,r)}catch{}n&&Ct(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Qs()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const zt=ye.WebSocket||ye.MozWebSocket;class Sr extends wr{createSocket(e,t,i){return ei?new zt(e,t,i):t?new zt(e,t):new zt(e)}doWrite(e,t){this.ws.send(t)}}class Er extends ls{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=nr(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(t).getReader(),n=ir();n.readable.pipeTo(e.writable),this._writer=n.writable.getWriter();const r=()=>{i.read().then(({done:o,value:c})=>{o||(this.onPacket(c),r())}).catch(o=>{})};r();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],n=t===e.length-1;this._writer.write(i).then(()=>{n&&Ct(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const kr={websocket:Sr,webtransport:Er,polling:br},Ar=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Tr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Jt(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),i=s.indexOf("]");t!=-1&&i!=-1&&(s=s.substring(0,t)+s.substring(t,i).replace(/:/g,";")+s.substring(i,s.length));let n=Ar.exec(s||""),r={},a=14;for(;a--;)r[Tr[a]]=n[a]||"";return t!=-1&&i!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=Cr(r,r.path),r.queryKey=Ir(r,r.query),r}function Cr(s,e){const t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Ir(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,r){n&&(t[n]=r)}),t}const jt=typeof addEventListener=="function"&&typeof removeEventListener=="function",wt=[];jt&&addEventListener("offline",()=>{wt.forEach(s=>s())},!1);class Be extends Q{constructor(e,t){if(super(),this.binaryType=ar,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const i=Jt(e);t.hostname=i.host,t.secure=i.protocol==="https"||i.protocol==="wss",t.port=i.port,i.query&&(t.query=i.query)}else t.host&&(t.hostname=Jt(t.host).host);It(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(i=>{const n=i.prototype.name;this.transports.push(n),this._transportsByName[n]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=fr(this.opts.query)),jt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},wt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Js,t.transport=e,this.id&&(t.sid=this.id);const i=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Be.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Be.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const n=this.writeBuffer[i].data;if(n&&(t+=ur(n)),i>0&&t>this._maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Ct(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,i){return this._sendPacket("message",e,t,i),this}send(e,t,i){return this._sendPacket("message",e,t,i),this}_sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const r={type:e,data:t,options:i};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(Be.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),jt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=wt.indexOf(this._offlineEventListener);i!==-1&&wt.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Be.protocol=Js;class Rr extends Be{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),i=!1;Be.priorWebsocketSuccess=!1;const n=()=>{i||(t.send([{type:"ping",data:"probe"}]),t.once("packet",b=>{if(!i)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Be.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(p(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=t.name,this.emitReserved("upgradeError",f)}}))};function r(){i||(i=!0,p(),t.close(),t=null)}const a=b=>{const f=new Error("probe error: "+b);f.transport=t.name,r(),this.emitReserved("upgradeError",f)};function o(){a("transport closed")}function c(){a("socket closed")}function m(b){t&&b.name!==t.name&&r()}const p=()=>{t.removeListener("open",n),t.removeListener("error",a),t.removeListener("close",o),this.off("close",c),this.off("upgrading",m)};t.once("open",n),t.once("error",a),t.once("close",o),this.once("close",c),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}}let xr=class extends Rr{constructor(e,t={}){const i=typeof e=="object"?e:t;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(n=>kr[n]).filter(n=>!!n)),super(e,i)}};function Nr(s,e="",t){let i=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),i=Jt(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+e,i.href=i.protocol+"://"+r+(t&&t.port===i.port?"":":"+i.port),i}const Or=typeof ArrayBuffer=="function",Lr=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,ti=Object.prototype.toString,Mr=typeof Blob=="function"||typeof Blob<"u"&&ti.call(Blob)==="[object BlobConstructor]",Br=typeof File=="function"||typeof File<"u"&&ti.call(File)==="[object FileConstructor]";function cs(s){return Or&&(s instanceof ArrayBuffer||Lr(s))||Mr&&s instanceof Blob||Br&&s instanceof File}function St(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,i=s.length;t<i;t++)if(St(s[t]))return!0;return!1}if(cs(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return St(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&St(s[t]))return!0;return!1}function Dr(s){const e=[],t=s.data,i=s;return i.data=Qt(t,e),i.attachments=e.length,{packet:i,buffers:e}}function Qt(s,e){if(!s)return s;if(cs(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let i=0;i<s.length;i++)t[i]=Qt(s[i],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=Qt(s[i],e));return t}return s}function Pr(s,e){return s.data=Xt(s.data,e),delete s.attachments,s}function Xt(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=Xt(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=Xt(s[t],e));return s}const Vr=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var D;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(D||(D={}));class Ur{constructor(e){this.replacer=e}encode(e){return(e.type===D.EVENT||e.type===D.ACK)&&St(e)?this.encodeAsBinary({type:e.type===D.EVENT?D.BINARY_EVENT:D.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===D.BINARY_EVENT||e.type===D.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Dr(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}}class us extends Q{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const i=t.type===D.BINARY_EVENT;i||t.type===D.BINARY_ACK?(t.type=i?D.EVENT:D.ACK,this.reconstructor=new qr(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(cs(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const i={type:Number(e.charAt(0))};if(D[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===D.BINARY_EVENT||i.type===D.BINARY_ACK){const r=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const a=e.substring(r,t);if(a!=Number(a)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(a)}if(e.charAt(t+1)==="/"){const r=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(r,t)}else i.nsp="/";const n=e.charAt(t+1);if(n!==""&&Number(n)==n){const r=t+1;for(;++t;){const a=e.charAt(t);if(a==null||Number(a)!=a){--t;break}if(t===e.length)break}i.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(us.isPayloadValid(i.type,r))i.data=r;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case D.CONNECT:return Is(t);case D.DISCONNECT:return t===void 0;case D.CONNECT_ERROR:return typeof t=="string"||Is(t);case D.EVENT:case D.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Vr.indexOf(t[0])===-1);case D.ACK:case D.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class qr{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Pr(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Is(s){return Object.prototype.toString.call(s)==="[object Object]"}const $r=Object.freeze(Object.defineProperty({__proto__:null,Decoder:us,Encoder:Ur,get PacketType(){return D}},Symbol.toStringTag,{value:"Module"}));function Se(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const zr=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class si extends Q{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Se(e,"open",this.onopen.bind(this)),Se(e,"packet",this.onpacket.bind(this)),Se(e,"error",this.onerror.bind(this)),Se(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var i,n,r;if(zr.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const a={type:D.EVENT,data:t};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const p=this.ids++,b=t.pop();this._registerAckCallback(p,b),a.id=p}const o=(n=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||n===void 0?void 0:n.writable,c=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,t){var i;const n=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(n===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);t.call(this,new Error("operation has timed out"))},n),a=(...o)=>{this.io.clearTimeoutFn(r),t.apply(this,o)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...t){return new Promise((i,n)=>{const r=(a,o)=>a?n(a):i(o);r.withError=!0,t.push(r),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...r)=>(this._queue[0],n!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(n)):(this._queue.shift(),t&&t(null,...r)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:D.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case D.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case D.EVENT:case D.BINARY_EVENT:this.onevent(e);break;case D.ACK:case D.BINARY_ACK:this.onack(e);break;case D.DISCONNECT:this.ondisconnect();break;case D.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let i=!1;return function(...n){i||(i=!0,t.packet({type:D.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:D.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,e.data)}}}function Xe(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}Xe.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=(Math.floor(e*10)&1)==0?s-t:s+t}return Math.min(s,this.max)|0};Xe.prototype.reset=function(){this.attempts=0};Xe.prototype.setMin=function(s){this.ms=s};Xe.prototype.setMax=function(s){this.max=s};Xe.prototype.setJitter=function(s){this.jitter=s};class Zt extends Q{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,It(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Xe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||$r;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new xr(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=Se(t,"open",function(){i.onopen(),e&&e()}),r=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),e?e(o):this.maybeReconnectOnOpen()},a=Se(t,"error",r);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{n(),r(new Error("timeout")),t.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(n),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Se(e,"ping",this.onping.bind(this)),Se(e,"data",this.ondata.bind(this)),Se(e,"error",this.onerror.bind(this)),Se(e,"close",this.onclose.bind(this)),Se(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Ct(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new si(this,e,t),this.nsps[e]=i),i}_destroy(e){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const it={};function Et(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=Nr(s,e.path||"/socket.io"),i=t.source,n=t.id,r=t.path,a=it[n]&&r in it[n].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let c;return o?c=new Zt(i,e):(it[n]||(it[n]=new Zt(i,e)),c=it[n]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(Et,{Manager:Zt,Socket:si,io:Et,connect:Et});let J=null;const at=new Map;function ii(){return J!=null&&J.connected||(J=Et(void 0,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:10}),J.on("connect",()=>{Ye("status",{connected:!0})}),J.on("disconnect",()=>{Ye("status",{connected:!1})}),J.on("ai_response_start",e=>Ye("start",e)),J.on("ai_response_chunk",e=>Ye("chunk",e)),J.on("ai_response_complete",e=>Ye("complete",e)),J.on("error",e=>Ye("error",e))),J}function Hr(s,e,t=null,i=null){J!=null&&J.connected||ii(),J.emit("chat_message",{message:s,conversationId:e,image:t,userId:i})}function mt(s,e){return at.has(s)||at.set(s,new Set),at.get(s).add(e),()=>at.get(s).delete(e)}function Ye(s,e){const t=at.get(s);t&&t.forEach(i=>i(e))}function Rs(){J==null||J.disconnect(),J=null}var Fr=B('<div class="scan-line svelte-mv2iry"></div>'),Kr=B('<div class="data-point svelte-mv2iry"></div>'),Yr=B('<div><span class="role svelte-mv2iry"> </span> <span class="content"> </span></div>'),Wr=B('<div class="conversation-panel svelte-mv2iry"><div class="panel-header svelte-mv2iry"><span>RECENT INTERACTIONS</span></div> <div class="conversation-list svelte-mv2iry"></div></div>'),Gr=B('<div class="jarvis-hud svelte-mv2iry"><!> <!> <div class="status-panel svelte-mv2iry"><div class="panel-header svelte-mv2iry"><span class="system-name svelte-mv2iry">J.A.R.V.I.S. SYSTEM</span> <span class="timestamp svelte-mv2iry"> </span></div> <div class="status-grid svelte-mv2iry"><div class="status-item svelte-mv2iry"><span class="label svelte-mv2iry">SYSTEM STATUS:</span> <span> </span></div> <div class="status-item svelte-mv2iry"><span class="label svelte-mv2iry">CONNECTION:</span> <span> </span></div> <div class="status-item svelte-mv2iry"><span class="label svelte-mv2iry">SECURITY LEVEL:</span> <span class="value green svelte-mv2iry"> </span></div> <div class="status-item svelte-mv2iry"><span class="label svelte-mv2iry">VOICE ENGINE:</span> <span> </span></div></div></div> <!> <div class="data-panel svelte-mv2iry"><div class="panel-header svelte-mv2iry"><span>SYSTEM MONITORING</span></div> <div class="graphs svelte-mv2iry"><div class="graph-container svelte-mv2iry"><div class="graph-label svelte-mv2iry">CPU USAGE</div> <div class="graph-bar svelte-mv2iry"></div></div> <div class="graph-container svelte-mv2iry"><div class="graph-label svelte-mv2iry">MEMORY</div> <div class="graph-bar svelte-mv2iry"></div></div> <div class="graph-container svelte-mv2iry"><div class="graph-label svelte-mv2iry">NETWORK</div> <div class="graph-bar svelte-mv2iry"></div></div></div></div> <div class="commands-panel svelte-mv2iry"><div class="panel-header svelte-mv2iry"><span>QUICK COMMANDS</span></div> <div class="commands-list svelte-mv2iry"><button class="command-btn svelte-mv2iry">SYSTEM STATUS</button> <button class="command-btn svelte-mv2iry">OPEN APPLICATION</button> <button class="command-btn svelte-mv2iry">NETWORK INFO</button> <button class="command-btn svelte-mv2iry">SECURITY SCAN</button></div></div></div>');function Jr(s,e){xe(e,!1);const t=()=>Ee(ae,"$conversation",n),i=()=>Ee(G,"$voice",n),[n,r]=He(),a=Y(),o=Y(),c=Y(),m=Y();let p=Y(),b=Y([]),f=Y([]),y,k;kt(()=>{P(),v(),_(),C()}),lt(()=>{y&&clearInterval(y),k&&clearInterval(k)});function P(){for(let R=0;R<20;R++)l(b).push({id:R,x:Math.random()*100,opacity:Math.random()*.3+.1,speed:Math.random()*2+1})}function v(){for(let R=0;R<15;R++)l(f).push({id:R,x:Math.random()*100,y:Math.random()*100,size:Math.random()*3+1,opacity:Math.random()*.7+.3})}function _(){y=setInterval(()=>{$(b,l(b).map(R=>({...R,x:(R.x+R.speed)%100})))},50)}function C(){k=setInterval(()=>{$(f,l(f).map(R=>({...R,opacity:Math.random()>.7?Math.random()*.7+.3:R.opacity,x:Math.random()*100,y:Math.random()*100})))},1e3)}function H(){return new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function E(){const R=t().isLoading,O=i().isSpeaking,pe=i().isListening;return R?"PROCESSING":O?"SPEAKING":pe?"LISTENING":"STANDBY"}function N(){return i().supported?"CONNECTED":"OFFLINE"}function T(){const R=E();return R==="STANDBY"?"LEVEL 5 - MAXIMUM":R==="PROCESSING"?"LEVEL 3 - ENHANCED":"LEVEL 4 - STANDARD"}Ge(()=>{},()=>{$(a,H())}),Ge(()=>{},()=>{$(o,E())}),Ge(()=>{},()=>{$(c,N())}),Ge(()=>{},()=>{$(m,T())}),ts(),Oe();var S=Gr(),q=d(S);Je(q,1,()=>l(b),R=>R.id,(R,O)=>{var pe=Fr();j(()=>tt(pe,`left: ${l(O),x(()=>l(O).x)??""}%; opacity: ${l(O),x(()=>l(O).opacity)??""};`)),A(R,pe)});var L=u(q,2);Je(L,1,()=>l(f),R=>R.id,(R,O)=>{var pe=Kr();j(()=>tt(pe,`
        left: ${l(O),x(()=>l(O).x)??""}%; 
        top: ${l(O),x(()=>l(O).y)??""}%; 
        width: ${l(O),x(()=>l(O).size)??""}px; 
        height: ${l(O),x(()=>l(O).size)??""}px; 
        opacity: ${l(O),x(()=>l(O).opacity)??""};
      `)),A(R,pe)});var U=u(L,2),ie=d(U),X=u(d(ie),2),le=d(X,!0);h(X),h(ie);var ce=u(ie,2),ne=d(ce),Z=u(d(ne),2),de=d(Z,!0);h(Z),h(ne);var z=u(ne,2),g=u(d(z),2),M=d(g,!0);h(g),h(z);var ee=u(z,2),_e=u(d(ee),2),fe=d(_e,!0);h(_e),h(ee);var be=u(ee,2),ge=u(d(be),2),te=d(ge,!0);h(ge),h(be),h(ce),h(U);var ve=u(U,2);{var De=R=>{var O=Wr(),pe=u(d(O),2);Je(pe,5,()=>(t(),x(()=>t().messages.slice(-3))),Tt,(dt,ke)=>{var Ie=Yr(),Ze=d(Ie),we=d(Ze);h(Ze);var Ke=u(Ze,2),Rt=d(Ke);h(Ke),h(Ie),j(ni=>{he(Ie,1,`conversation-item ${l(ke),x(()=>l(ke).role)??""}`,"svelte-mv2iry"),W(we,`${l(ke),x(()=>l(ke).role==="user"?"USER":"JARVIS")??""}:`),W(Rt,`${ni??""}${l(ke),x(()=>l(ke).content.length>60?"...":"")??""}`)},[()=>(l(ke),x(()=>l(ke).content.substring(0,60)))]),A(dt,Ie)}),h(pe),h(O),A(R,O)};F(ve,R=>{t(),x(()=>t().messages.length>0)&&R(De)})}var Ce=u(ve,2),Pe=u(d(Ce),2),Le=d(Pe),Fe=u(d(Le),2);tt(Fe,`width: ${x(()=>Math.random()*60+20)??""}%`),h(Le);var w=u(Le,2),V=u(d(w),2);tt(V,`width: ${x(()=>Math.random()*70+10)??""}%`),h(w);var K=u(w,2),I=u(d(K),2);tt(I,`width: ${x(()=>Math.random()*50+30)??""}%`),h(K),h(Pe),h(Ce),ss(2),h(S),At(S,R=>$(p,R),()=>l(p)),j(()=>{W(le,l(a)),he(Z,1,`value ${l(o)==="STANDBY"?"green":l(o)==="PROCESSING"?"yellow":"blue"}`,"svelte-mv2iry"),W(de,l(o)),he(g,1,`value ${l(c)==="CONNECTED"?"green":"red"}`,"svelte-mv2iry"),W(M,l(c)),W(fe,l(m)),he(ge,1,`value ${i(),x(()=>i().isSpeaking?"blue":"green")??""}`,"svelte-mv2iry"),W(te,(i(),x(()=>i().isSpeaking?"ACTIVE":"READY")))}),A(s,S),Ne(),r()}class jr{constructor(){this.isMonitoring=!1,this.monitoringInterval=null,this.lastInteractionTime=Date.now(),this.systemChecks=[],this.notifications=[],this.adviceQueue=[]}startMonitoring(){this.isMonitoring||(this.isMonitoring=!0,this.lastInteractionTime=Date.now(),this.monitoringInterval=setInterval(()=>{this.performSystemCheck(),this.checkForNotifications(),this.offerProactiveAssistance()},3e4),this.setupInteractionMonitoring())}stopMonitoring(){this.isMonitoring=!1,this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null)}setupInteractionMonitoring(){this.conversationUnsubscribe=ae.subscribe(e=>{e.messages.length>0&&(this.lastInteractionTime=Date.now())}),this.voiceUnsubscribe=G.subscribe(e=>{(e.isListening||e.isSpeaking)&&(this.lastInteractionTime=Date.now())})}performSystemCheck(){Date.now()-this.lastInteractionTime>3e5&&this.offerIdleAssistance();const i=new Date().getHours();i>=6&&i<12?this.offerMorningGreeting():i>=12&&i<17?this.offerAfternoonUpdate():i>=17&&i<22?this.offerEveningBriefing():this.offerNightlyStatus(),this.checkDailyReminders()}checkForNotifications(){const e=[];Math.random()>.95&&e.push({type:"system",priority:"low",message:"System maintenance scheduled for tonight",timestamp:Date.now()}),this.notifications=[...this.notifications,...e]}offerProactiveAssistance(){const t=Date.now()-this.lastInteractionTime;if(t<1e4)return;const i=new Date().getHours();new Date().getDay(),t>12e4&&this.offerIdleSuggestions(),i===8&&Math.random()>.7&&this.addAdvice("Sir, would you like me to prepare your morning briefing?"),i===18&&Math.random()>.7&&this.addAdvice("Sir, shall I prepare tomorrow's schedule overview?")}offerIdleAssistance(){const e=Date.now()-this.lastInteractionTime;e>6e5?this.addAdvice("Sir, I notice you've been inactive. Shall I put the system in standby mode?"):e>3e5&&this.addAdvice("Sir, would you like a status update on any ongoing processes?")}offerMorningGreeting(){Math.random()>.8&&this.addAdvice("Good morning, sir. The weather is favorable for your commute. Traffic should be light.")}offerAfternoonUpdate(){Math.random()>.8&&this.addAdvice("Good afternoon, sir. I've optimized your system performance and cleared temporary files.")}offerEveningBriefing(){Math.random()>.8&&this.addAdvice("Good evening, sir. Shall I prepare tomorrow's agenda review?")}offerNightlyStatus(){Math.random()>.8&&this.addAdvice("Good evening, sir. System security scan completed. All clear.")}checkDailyReminders(){const e=new Date,t=e.getHours(),i=e.getDay();t===9&&i===1&&Math.random()>.7&&this.addAdvice("Sir, today is Monday. Shall I prioritize your weekly planning tasks?"),t===17&&i>=1&&i<=5&&Math.random()>.7&&this.addAdvice("Sir, shall I prepare your commute information for departure?")}offerIdleSuggestions(){const e=["Sir, would you like me to optimize system performance?","Shall I check for any pending updates?","Would you like a brief status report on system operations?","Sir, I can adjust your desktop environment if you're taking a break.","Shall I dim the screen to reduce eye strain?"];if(Math.random()>.6){const t=e[Math.floor(Math.random()*e.length)];this.addAdvice(t)}}addAdvice(e){this.adviceQueue.push({id:Date.now(),message:e,timestamp:Date.now(),priority:"medium"}),this.adviceQueue.length>5&&this.adviceQueue.shift()}getRecentAdvice(){return this.adviceQueue.slice(-3)}getSystemStatus(){return{lastInteraction:this.lastInteractionTime,isMonitoring:this.isMonitoring,notificationCount:this.notifications.length,adviceQueueLength:this.adviceQueue.length,idleTime:Date.now()-this.lastInteractionTime,timeOfDay:this.getTimeOfDay(),dayOfWeek:new Date().getDay()}}getTimeOfDay(){const e=new Date().getHours();return e>=6&&e<12?"morning":e>=12&&e<17?"afternoon":e>=17&&e<22?"evening":"night"}triggerImmediateAssistance(e,t={}){switch(e){case"system_status":return"Sir, system status: All systems operational. CPU usage at 23%, memory at 45%. No critical alerts.";case"security_scan":return"Security scan initiated. No threats detected. System remains secure.";case"performance_optimize":return"Performance optimization complete. System running at peak efficiency.";case"schedule_review":return"Reviewing your schedule... Upcoming meetings: 2 today, 1 tomorrow. Nothing urgent requires immediate attention.";case"commute_info":return"Traffic is light. Your usual route should take approximately 25 minutes.";default:return"Sir, I'm ready to assist. What would you like me to do?"}}}const xs=new jr;function Qr(){const{subscribe:s,set:e,update:t}=ht({userId:null,name:"",email:""});return{subscribe:s,setProfile(i){e({userId:i.id,name:i.name,email:i.email})}}}const gt=Qr();var Xr=B('<div class="camera-sidebar svelte-1uha8ag"><!></div>'),Zr=B('<div class="error-msg svelte-1uha8ag"> </div>'),ea=B('<div class="modal-backdrop svelte-1uha8ag"><div class="modal svelte-1uha8ag"><h3 class="svelte-1uha8ag">Enter your details</h3> <div class="field svelte-1uha8ag"><label for="user-name">Name</label> <input id="user-name" type="text" placeholder="Your name" class="svelte-1uha8ag"/></div> <div class="field svelte-1uha8ag"><label for="user-email">Email</label> <input id="user-email" type="email" placeholder="you@example.com" class="svelte-1uha8ag"/></div> <!> <button class="submit-btn svelte-1uha8ag"> </button></div></div>'),ta=B('<div class="app svelte-1uha8ag"><header class="header svelte-1uha8ag"><div class="header-left svelte-1uha8ag"><div class="logo svelte-1uha8ag"><svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.17A7 7 0 0113 21.93V22h-2v-.07A7 7 0 013.17 16H2a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"></path></svg> <span class="logo-text svelte-1uha8ag">N.O.V.A.</span></div> <!></div> <div class="header-right svelte-1uha8ag"><button class="icon-btn svelte-1uha8ag" title="New conversation"><svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg></button> <button class="icon-btn svelte-1uha8ag" title="Settings"><svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.49.49 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"></path></svg></button></div></header> <div class="main-area svelte-1uha8ag"><!> <!></div> <div class="controls-area svelte-1uha8ag"><div class="controls-top svelte-1uha8ag"><!> <!></div> <!> <div class="text-input-row svelte-1uha8ag"><input type="text" placeholder="Type a message or just speak..." class="svelte-1uha8ag"/> <button class="send-btn svelte-1uha8ag" aria-label="Send message"><svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg></button></div></div> <!></div> <!> <!>',1);function ua(s,e){xe(e,!1);const t=()=>Ee(ue,"$settings",r),i=()=>Ee($e,"$camera",r),n=()=>Ee(ae,"$conversation",r),[r,a]=He();let o=Y(""),c="",m=[],p=!1,b=Y(!1),f=Y(!1),y=Y(""),k=Y(""),P=Y(""),v=Y(!1);function _(){return document.querySelector(".camera-feed")}kt(async()=>{const w=localStorage.getItem("nova-conversation-id");w&&ae.init(w),console.log("Starting continuous conversation..."),await oe.start(),console.log("Continuous conversation started, setting up callbacks"),oe.onUserMessage(I=>{console.log("Continuous conversation received text:",I),C(I)}),oe.onInterruption(()=>{console.log("Conversation interrupted")}),ii();const V=localStorage.getItem("nova-user-profile");if(V){const I=JSON.parse(V);gt.setProfile(I)}else $(f,!0);const K=I=>{I.ctrlKey&&I.shiftKey&&I.key==="J"&&(I.preventDefault(),$(b,!l(b)),p=l(b)),I.ctrlKey&&I.shiftKey&&I.key==="A"&&(I.preventDefault(),p=!p,p&&$(b,!0))};window.addEventListener("keydown",K),m.push(()=>{window.removeEventListener("keydown",K)}),p&&xs.startMonitoring(),m.push(mt("start",({conversationId:I})=>{ae.init(I),localStorage.setItem("nova-conversation-id",I),c="",ae.addStreamingMessage(),ae.setLoading(!0),oe.startAIResponse()})),m.push(mt("chunk",({chunk:I})=>{c+=I,ae.updateStreamingMessage(c),t().autoSpeak&&I.trim()&&oe.queueSpeech(I)})),m.push(mt("complete",({response:I,conversationId:R,commands:O})=>{ae.completeStreamingMessage(I,O),ae.setLoading(!1),c="",oe.endAIResponse(),t().autoSpeak&&I&&$s(I,{rate:t().speechRate,pitch:t().speechPitch,volume:t().speechVolume,voiceName:t().voiceName,lang:t().language})})),m.push(mt("error",({message:I})=>{ae.setLoading(!1),ae.addMessage("assistant",`Error: ${I}`),oe.endAIResponse()}))}),lt(()=>{m.forEach(w=>w&&w()),Rs()});async function C(w){if(!(w!=null&&w.trim()))return;console.log("handleSend called with text:",w);const V=w.trim();$(o,"");let K;ae.subscribe(O=>K=O)(),ae.addMessage("user",V);let I=null;if(i().enabled){const O=_();O&&(I=Fn(O))}console.log("Sending message via WebSocket:",V);let R;gt.subscribe(O=>R=O)(),Hr(V,K.conversationId,I,R.userId)}function H(w){C(w)}function E(w){w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),C(l(o)))}function N(){ae.clear(),localStorage.removeItem("nova-conversation-id")}lt(()=>{m.forEach(w=>w&&w()),Rs(),oe.stop(),xs.stopMonitoring()});async function T(){if(!(!l(y).trim()||!l(k).trim())){$(P,""),$(v,!0);try{const w=await Vn(l(y).trim(),l(k).trim());gt.setProfile(w),localStorage.setItem("nova-user-profile",JSON.stringify(w)),$(f,!1)}catch{try{const K={id:(crypto==null?void 0:crypto.randomUUID)&&crypto.randomUUID()||`local-${Date.now()}`,name:l(y).trim(),email:l(k).trim()};gt.setProfile(K),localStorage.setItem("nova-user-profile",JSON.stringify(K)),$(f,!1)}catch{$(P,"Failed to save your details. Please try again.")}}finally{$(v,!1)}}}Oe();var S=ta(),q=ct(S),L=d(q),U=d(L),ie=u(d(U),2);$n(ie,{}),h(U);var X=u(U,2),le=d(X),ce=u(le,2);h(X),h(L);var ne=u(L,2),Z=d(ne);{var de=w=>{var V=Xr(),K=d(V);Es(K,{compact:!0}),h(V),A(w,V)};F(Z,w=>{i().enabled&&w(de)})}var z=u(Z,2);hn(z,{}),h(ne);var g=u(ne,2),M=d(g),ee=d(M);{var _e=w=>{Es(w,{compact:!0})};F(ee,w=>{i().enabled||w(_e)})}var fe=u(ee,2);On(fe,{}),h(M);var be=u(M,2);xn(be,{onResult:H,get disabled(){return n().isLoading}});var ge=u(be,2),te=d(ge);Ue(te);var ve=u(te,2);h(ge),h(g);var De=u(g,2);Bn(De,{}),h(q);var Ce=u(q,2);{var Pe=w=>{Jr(w,{})};F(Ce,w=>{l(b)&&w(Pe)})}var Le=u(Ce,2);{var Fe=w=>{var V=ea(),K=d(V),I=u(d(K),2),R=u(d(I),2);Ue(R),h(I);var O=u(I,2),pe=u(d(O),2);Ue(pe),h(O);var dt=u(O,2);{var ke=we=>{var Ke=Zr(),Rt=d(Ke,!0);h(Ke),j(()=>W(Rt,l(P))),A(we,Ke)};F(dt,we=>{l(P)&&we(ke)})}var Ie=u(dt,2),Ze=d(Ie,!0);h(Ie),h(K),h(V),j(we=>{Ie.disabled=we,W(Ze,l(v)?"Saving...":"Continue")},[()=>l(v)||!l(y).trim()||!l(k).trim()]),Bt(R,()=>l(y),we=>$(y,we)),Bt(pe,()=>l(k),we=>$(k,we)),se("click",Ie,T),A(w,V)};F(Le,w=>{l(f)&&w(Fe)})}j(w=>{te.disabled=n().isLoading,ve.disabled=w},[()=>!l(o).trim()||n().isLoading]),se("click",le,N),se("click",ce,()=>ue.toggleSettings()),Bt(te,()=>l(o),w=>$(o,w)),se("keydown",te,E),se("click",ve,()=>C(l(o))),A(s,S),Ne(),a()}export{ua as component};
